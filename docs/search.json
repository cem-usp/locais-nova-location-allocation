[
  {
    "objectID": "index.html#overview",
    "href": "index.html#overview",
    "title": "",
    "section": "Overview",
    "text": "Overview\nThis report provides a reproducible pipeline for calculating the Maximal Coverage Location-Allocation to identify optimal locations for one or more facilities, specifically targeting food establishments, to maximize accessibility and coverage within the defined area.\nFor instructions on how to run the pipeline, see the repository README."
  },
  {
    "objectID": "index.html#problem",
    "href": "index.html#problem",
    "title": "",
    "section": "Problem",
    "text": "Problem"
  },
  {
    "objectID": "index.html#data-availability",
    "href": "index.html#data-availability",
    "title": "",
    "section": "Data Availability",
    "text": "Data Availability\n\nThe processed data are available in csv, rds and parquet formats through dedicated repositories on the Open Science Framework (OSF). A metadata file is included alongside the validated datasets.\nOnly authorized personnel can access the processed files. They are protected with RSA 4096-bit encryption (OpenSSL) and a 32-byte password to ensure data security."
  },
  {
    "objectID": "index.html#methods",
    "href": "index.html#methods",
    "title": "",
    "section": "Methods",
    "text": "Methods\nSource of Data\nThe data used in this report come from the following sources:\n\nBrazilian Federal Revenue Service (RFB)\n\nData on legal entities from the National Register of Legal Entities (CNPJ) database, used for company identification (Brasil et al., n.d.).\nData on Brazilian agencies and municipalities (Tabela de Órgãos e Municípios, TOM) (Brasil & Sistema de Vigilância Alimentar e Nutricional, n.d.).\n\n\nBrazilian Institute of Geography and Statistics (IBGE)\n\nMunicipality data via the geobr R package (Pereira & Goncalves, n.d.).\nMunicipality and census tract shapes via the geobr R package (Pereira & Goncalves, n.d.).\nCensus tract population data via the censobr R package (Pereira & Goncalves, n.d.).\nOpen spatial datasets of Brazilian addresses from the National Address Register for Statistical Purposes (CNEFE), used for geocoding via the geocodebr R package (Pereira & Herszenhut, n.d.).\n\n\nCenter for Metropolitan Studies (CEM)\n\nLookup table providing the classification linking the establishments CNAEs (National Classification of Economic Activities) codes to the Locais-Nova groups (Fernandes & Giannotti, 2025). This data will remain private until further notice.\n\n\nMalaria Atlas Project (MAP)\n\nData on spatial friction based on the Global Walking Only Friction Surface dataset (Malaria Atlas Project, 2019), used to calculate travel times.\n\n\nOpenStreetMap (OSM)\n\nData on road and footpaths (OpenStreetMap Contributors, n.d.), used to calculate travel times.\n\n\n\nThe dataset related to the Brazilian Federal Revenue Service (RFB) used in this report was processed by Vartanian et al. ((2025)) and has its own dedicated pipeline, which can be accessed at: https://cem-usp.github.io/locais-nova-rfb-geocoding/.\nData Munging\nThe data munging follow the data science workflow outlined by Wickham et al. (2023), as illustrated in Figure 1. All processes were made using the Quarto publishing system (Allaire et al., n.d.), the R programming language (R Core Team, n.d.) and several R packages.\nFor data manipulation and workflow, priority was given to packages from the tidyverse, rOpenSci and r-spatial ecosystems, as well as other packages adhering to the tidy tools manifesto (Wickham, 2023).\n\n\nFigure 1: Data science workflow created by Wickham, Çetinkaya-Runde, and Grolemund.\n\n\nSource: Reproduced from Wickham et al. (2023).\n\n\n\nCode Style\nThe Tidyverse code style guide (Wickham, n.d.-a) and design principles (Wickham, n.d.-b) were followed to ensure consistency and enhance readability.\nReproducibility\nThe pipeline is fully reproducible and can be run again at any time. To ensure consistent results, the renv package (Ushey & Wickham, n.d.) is used to manage and restore the R environment. See the README file in the code repository to learn how to run it."
  },
  {
    "objectID": "index.html#set-the-environment",
    "href": "index.html#set-the-environment",
    "title": "",
    "section": "Set the Environment",
    "text": "Set the Environment\n\n\n\n\n\n\nThis section sets up the R environment needed for the workflow.\n\n\n\nLoad Packages\n\nlibrary(askpass)\nlibrary(arrow)\nlibrary(brandr)\nlibrary(beepr)\nlibrary(censobr)\nlibrary(dplyr)\nlibrary(fs)\nlibrary(ggplot2)\nlibrary(geobr)\nlibrary(here)\nlibrary(htmltools)\n# install.packages(\"remotes\")\n# remotes::install_github(\"danielvartan/locationallocation\")\nlibrary(locationallocation)\n# remotes::install_github(\"danielvartan/lockr\")\nlibrary(lockr) # github.com/danielvartan/lockr\nlibrary(magrittr)\n# remotes::install_github(\"danielvartan/orbis\")\nlibrary(orbis) # github.com/danielvartan/orbis\nlibrary(osfr)\nlibrary(raster)\nlibrary(readr)\nlibrary(sf)\nlibrary(stars)\nlibrary(stringr)\nlibrary(tidyr)\n\nSet Keys\n\n\n\n\n\n\nSee the Data Availability section for more information.\n\n\n\n\nosf_auth(Sys.getenv(\"OSF_PAT\")) # askpass())\n\n\npublic_key &lt;- here(\"_ssh\", \"id_rsa.pub\")\n\n\nprivate_key &lt;- here(\"_ssh\", \"id_rsa\")\n\n\npassword &lt;- Sys.getenv(\"ACESSOSAN_PASSWORD\") # askpass()\n\nSet Data Directory\n\ndata_dir &lt;- here(\"data\")\n\n\nif (!dir_exists(data_dir)) dir_create(data_dir, recurse = TRUE)\n\nSet Initial Variables\n\nset.seed(2025)\n\n\n\n\n\n\n\nThe year variable is related to the year of the RFB dataset.\n\n\n\n\nyear &lt;- 2025\n\n\n\n\n\n\n\nThis pipeline utilizes the Locais-Nova scale groups (Silva et al., 2025) to classify food establishments. The G0 group is a distinct subset comprising establishments from the G1-G2 group that are not simultaneously classified under G3 or G4.\n\n\n\n\nlocais_nova_group &lt;- \"G0\" # G1-G2, G3, G4\n\n\n\n\n\n\n\nThe objective_minutes variable defines the maximum travel time (in minutes) for coverage analysis.\n\n\n\n\nobjective_minutes &lt;- 15\n\n\n\n\n\n\n\nSelect only one municipality at a time by uncommenting the corresponding IBGE code.\n\n\n\n\nmunicipality &lt;- c( # IBGE Codes\n  # 1721000 # Palmas (2.227,329 km²)\n  2507507 # João Pessoa (210,044 km²)\n  # 3106200 # Belo Horizonte (331,354 km²)\n  # 3550308 # São Paulo (1.521,202 km²)\n  # 4314902 # Porto Alegre (495,977 km²)\n  # 5208707 # Goiânia (729,296 km²)\n  # 5300108 # Brasília (5.760,783 km²)\n)"
  },
  {
    "objectID": "index.html#download-rfb-data",
    "href": "index.html#download-rfb-data",
    "title": "",
    "section": "Download RFB Data",
    "text": "Download RFB Data\nDownload File\n\nosf_raw_data_id &lt;- \"2x6jb\"\n\n\nosf_raw_data_files &lt;-\n  osf_raw_data_id |&gt;\n  osf_retrieve_node() |&gt;\n  osf_ls_files(\n    type = \"file\",\n    pattern = \"2025-01.rds.lockr\",\n    n_max = Inf\n  )\n\nosf_raw_data_files\n\n\n  \n\n\n\n\nrfb_file &lt;-\n  osf_raw_data_files |&gt;\n  osf_download(path = data_dir, conflicts = \"overwrite\") |&gt;\n  extract2(\"local_path\")\n\nUnlock File\n\nrfb_file |&gt;\n  unlock_file(\n    private_key = private_key,\n    suffix = \".lockr\",\n    remove_file = TRUE,\n    password = password\n  )"
  },
  {
    "objectID": "index.html#download-and-import-municipality-shape",
    "href": "index.html#download-and-import-municipality-shape",
    "title": "",
    "section": "Download and Import Municipality Shape",
    "text": "Download and Import Municipality Shape\n\nshape &lt;-\n  municipality |&gt;\n  read_municipality(\n    year = closest_geobr_year(year, verbose = FALSE),\n    showProgress = FALSE\n  ) |&gt;\n  dplyr::select(code_muni, geom) |&gt;\n  rename(municipality_code = code_muni, geometry = geom)\n\n\nshape"
  },
  {
    "objectID": "index.html#download-and-import-census-tract-population-data",
    "href": "index.html#download-and-import-census-tract-population-data",
    "title": "",
    "section": "Download and Import Census Tract Population Data",
    "text": "Download and Import Census Tract Population Data\n\ncensus_population_data &lt;-\n  read_tracts(\n    year = 2022, # Last available year\n    dataset = \"Basico\",\n    as_data_frame = FALSE,\n    showProgress = TRUE,\n    cache = TRUE,\n    verbose = TRUE\n  )\n#&gt; ℹ Reading data cached locally.\n\n\ncensus_population_data |&gt; glimpse()\n#&gt; FileSystemDataset with 1 Parquet file\n#&gt; 468,099 rows x 36 columns\n#&gt; $ code_tract               &lt;string&gt; \"110001505000002\", \"110001505000003\", \"11…\n#&gt; $ situacao                 &lt;string&gt; \"Urbana\", \"Urbana\", \"Urbana\", \"Urbana\", \"…\n#&gt; $ code_situacao            &lt;double&gt; 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 8, 8,…\n#&gt; $ code_type                &lt;double&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n#&gt; $ area_km2                 &lt;double&gt; 0.5393102, 0.2362175, 0.2118666, 0.505447…\n#&gt; $ code_region              &lt;double&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…\n#&gt; $ name_region              &lt;string&gt; \"Norte\", \"Norte\", \"Norte\", \"Norte\", \"Nort…\n#&gt; $ code_state               &lt;double&gt; 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 1…\n#&gt; $ name_state               &lt;string&gt; \"Rondônia\", \"Rondônia\", \"Rondônia\", \"Rond…\n#&gt; $ code_muni                &lt;double&gt; 1100015, 1100015, 1100015, 1100015, 11000…\n#&gt; $ name_muni                &lt;string&gt; \"Alta Floresta D'Oeste\", \"Alta Floresta D…\n#&gt; $ code_district            &lt;double&gt; 110001505, 110001505, 110001505, 11000150…\n#&gt; $ name_district            &lt;string&gt; \"Alta Floresta D'Oeste\", \"Alta Floresta D…\n#&gt; $ code_subdistrict         &lt;double&gt; 11000150500, 11000150500, 11000150500, 11…\n#&gt; $ name_subdistrict         &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n#&gt; $ code_neighborhood        &lt;double&gt; 1100015006, 1100015006, 1100015005, 11000…\n#&gt; $ name_neighborhood        &lt;string&gt; \"Redondo\", \"Redondo\", \"Princesa Isabel\", …\n#&gt; $ code_nucleo_urbano       &lt;double&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n#&gt; $ name_nucleo_urbano       &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n#&gt; $ code_favela              &lt;double&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n#&gt; $ name_favela              &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n#&gt; $ code_aglomerado          &lt;double&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n#&gt; $ name_aglomerado          &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n#&gt; $ code_intermediate        &lt;double&gt; 1102, 1102, 1102, 1102, 1102, 1102, 1102,…\n#&gt; $ name_intermediate        &lt;string&gt; \"Ji-Paraná\", \"Ji-Paraná\", \"Ji-Paraná\", \"J…\n#&gt; $ code_immediate           &lt;double&gt; 110005, 110005, 110005, 110005, 110005, 1…\n#&gt; $ name_immediate           &lt;string&gt; \"Cacoal\", \"Cacoal\", \"Cacoal\", \"Cacoal\", \"…\n#&gt; $ code_urban_concentration &lt;double&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n#&gt; $ name_urban_concentration &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n#&gt; $ V0001                    &lt;double&gt; 928, 556, 222, 785, 748, 631, 884, 762, 2…\n#&gt; $ V0002                    &lt;double&gt; 376, 243, 102, 318, 334, 298, 386, 357, 1…\n#&gt; $ V0003                    &lt;double&gt; 376, 243, 102, 318, 334, 298, 386, 357, 1…\n#&gt; $ V0004                    &lt;double&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 0, 0, 0,…\n#&gt; $ V0005                    &lt;double&gt; 2.8, 2.7, 2.6, 2.8, 2.6, 2.7, 2.7, 2.6, 2…\n#&gt; $ V0006                    &lt;double&gt; 0.0923, 0.0048, 0.0000, 0.0000, 0.0447, 0…\n#&gt; $ V0007                    &lt;double&gt; 336, 208, 85, 282, 291, 234, 329, 291, 10…\n#&gt; Call `print()` for full schema details"
  },
  {
    "objectID": "index.html#download-and-import-census-tract-shape-data",
    "href": "index.html#download-and-import-census-tract-shape-data",
    "title": "",
    "section": "Download and Import Census Tract Shape Data",
    "text": "Download and Import Census Tract Shape Data\n\ncensus_tract_data &lt;-\n  read_census_tract(\n    code_tract = municipality,\n    year = 2022, # Last available year\n    simplified = TRUE,\n    showProgress = TRUE,\n    cache = TRUE\n  )\n#&gt; Using year/date 2022\n\n\ncensus_tract_data |&gt; glimpse()\n#&gt; Rows: 1,778\n#&gt; Columns: 24\n#&gt; $ code_tract               &lt;dbl&gt; 250750705000001, 250750705000002, 25075070…\n#&gt; $ code_muni                &lt;dbl&gt; 2507507, 2507507, 2507507, 2507507, 250750…\n#&gt; $ name_muni                &lt;chr&gt; \"João Pessoa\", \"João Pessoa\", \"João Pessoa…\n#&gt; $ name_neighborhood        &lt;chr&gt; \"Varjão\", \"Varjão\", \"Varjão\", \"Varjão\", \"V…\n#&gt; $ code_neighborhood        &lt;dbl&gt; 2507507057, 2507507057, 2507507057, 250750…\n#&gt; $ code_subdistrict         &lt;dbl&gt; 25075070500, 25075070500, 25075070500, 250…\n#&gt; $ name_subdistrict         &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…\n#&gt; $ code_district            &lt;dbl&gt; 250750705, 250750705, 250750705, 250750705…\n#&gt; $ name_district            &lt;chr&gt; \"João Pessoa\", \"João Pessoa\", \"João Pessoa…\n#&gt; $ code_urban_concentration &lt;dbl&gt; 2507507, 2507507, 2507507, 2507507, 250750…\n#&gt; $ name_urban_concentration &lt;chr&gt; \"João Pessoa/PB\", \"João Pessoa/PB\", \"João …\n#&gt; $ code_state               &lt;dbl&gt; 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25…\n#&gt; $ name_state               &lt;chr&gt; \"Paraíba\", \"Paraíba\", \"Paraíba\", \"Paraíba\"…\n#&gt; $ code_immediate           &lt;dbl&gt; 250001, 250001, 250001, 250001, 250001, 25…\n#&gt; $ name_immediate           &lt;chr&gt; \"João Pessoa\", \"João Pessoa\", \"João Pessoa…\n#&gt; $ code_intermediate        &lt;dbl&gt; 2501, 2501, 2501, 2501, 2501, 2501, 2501, …\n#&gt; $ name_intermediate        &lt;chr&gt; \"João Pessoa\", \"João Pessoa\", \"João Pessoa…\n#&gt; $ code_region              &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, …\n#&gt; $ name_region              &lt;chr&gt; \"Nordeste\", \"Nordeste\", \"Nordeste\", \"Norde…\n#&gt; $ situacao                 &lt;chr&gt; \"Urbana\", \"Urbana\", \"Urbana\", \"Urbana\", \"U…\n#&gt; $ code_situacao            &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …\n#&gt; $ code_type                &lt;dbl&gt; 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, …\n#&gt; $ area_km2                 &lt;dbl&gt; 0.04631267269, 0.06271278332, 0.0554140691…\n#&gt; $ geom                     &lt;MULTIPOLYGON [°]&gt; MULTIPOLYGON (((-34.8739674..…"
  },
  {
    "objectID": "index.html#filter-and-join-census-data",
    "href": "index.html#filter-and-join-census-data",
    "title": "",
    "section": "Filter and Join Census Data",
    "text": "Filter and Join Census Data\n\ncensus_data &lt;-\n  census_population_data |&gt;\n  filter(code_muni == .env$municipality) |&gt;\n  dplyr::select(code_tract, V0001) |&gt;\n  rename(population = V0001) |&gt;\n  mutate(code_tract = as.numeric(code_tract)) |&gt;\n  collect() |&gt;\n  left_join(census_tract_data, by = \"code_tract\") |&gt;\n  rename(tract_code = code_tract) |&gt;\n  dplyr::select(tract_code, population, geom) |&gt;\n  st_as_sf()\n\n\ncensus_data |&gt; glimpse()\n#&gt; Rows: 1,778\n#&gt; Columns: 3\n#&gt; $ tract_code &lt;dbl&gt; 250750705000001, 250750705000002, 250750705000003, 25075…\n#&gt; $ population &lt;dbl&gt; 394, 774, 643, 317, 605, 607, 494, 1062, 337, 677, 637, …\n#&gt; $ geom       &lt;MULTIPOLYGON [°]&gt; MULTIPOLYGON (((-34.8739674..., MULTIPOLYGO…"
  },
  {
    "objectID": "index.html#import-data",
    "href": "index.html#import-data",
    "title": "",
    "section": "Import Data",
    "text": "Import Data\n\ndata &lt;-\n  here(data_dir, \"2025-01.rds\") |&gt;\n  read_rds()"
  },
  {
    "objectID": "index.html#filter-data",
    "href": "index.html#filter-data",
    "title": "",
    "section": "Filter Data",
    "text": "Filter Data\n\ndata &lt;-\n  data |&gt;\n  filter(\n    municipality_code == .env$municipality,\n    geocodebr_precision %in% c(\"numero\", \"numero_aproximado\")\n  ) |&gt;\n  dplyr::select(\n    cnpj,\n    longitude,\n    latitude,\n    locais_nova_g0,\n    locais_nova_g1_g2,\n    locais_nova_g3,\n    locais_nova_g4\n  )"
  },
  {
    "objectID": "index.html#transform-data",
    "href": "index.html#transform-data",
    "title": "",
    "section": "Transform Data",
    "text": "Transform Data\n\ndata &lt;-\n  data |&gt;\n  st_as_sf(coords = c(\"longitude\", \"latitude\"), crs = st_crs(shape)) |&gt;\n  pivot_longer(\n    cols = starts_with(\"locais_nova_\"),\n    names_to = \"group\",\n    values_to = \"value\"\n  ) |&gt;\n  filter(value == TRUE) |&gt;\n  mutate(\n    group =\n      group |&gt;\n      str_remove(\"locais_nova_\") |&gt;\n      str_to_upper() |&gt;\n      str_replace(\"_\", \"-\")\n  ) |&gt;\n  st_join(shape, join = st_within, left = FALSE) |&gt;\n  dplyr::select(cnpj, group, geometry)"
  },
  {
    "objectID": "index.html#exploratory-analysis",
    "href": "index.html#exploratory-analysis",
    "title": "",
    "section": "Exploratory Analysis",
    "text": "Exploratory Analysis\nGlimpse Data\n\ndata |&gt; glimpse()\n#&gt; Rows: 10,457\n#&gt; Columns: 3\n#&gt; $ cnpj     &lt;chr&gt; \"45.543.915/0103-06\", \"45.543.915/0103-06\", \"06.057.223/05…\n#&gt; $ group    &lt;chr&gt; \"G0\", \"G1-G2\", \"G0\", \"G1-G2\", \"G0\", \"G1-G2\", \"G0\", \"G1-G2\"…\n#&gt; $ geometry &lt;POINT [°]&gt; POINT (-34.87904145 -7.1205..., POINT (-34.87904145 …\n\nPlot Establishments\n\n\n\n\n\n\nThis plot illustrates the distribution of food establishments categorized by Locais-Nova scale groups (Silva et al., 2025). Note that an establishment may belong to multiple groups.\n\n\n\n\nggplot() +\n  geom_sf(\n    data = shape,\n    fill = \"gray90\",\n    color = \"black\"\n  ) +\n  geom_sf(\n    data = data,\n    mapping = aes(color = group),\n    size = 0.01\n  ) +\n  facet_wrap(~ group, ncol = 4) +\n  coord_sf(crs = 4326) +\n  scale_color_brand_d() +\n  scale_x_continuous(labels = NULL, breaks = NULL) +\n  scale_y_continuous(labels = NULL, breaks = NULL) +\n  theme(legend.position = \"none\") +\n  labs(\n    x = NULL,\n    y = NULL,\n    color = NULL\n  )\n\n\n\n\n\n\n\nPlot Tract Population\n\n\n\n\n\n\nThis plot illustrates the population distribution across census tracts within the selected municipality.\n\n\n\n\nggplot() +\n  geom_sf(\n    data = shape,\n    fill = \"gray90\",\n    color = \"black\"\n  ) +\n  geom_sf(\n    data = census_data,\n    mapping = aes(fill = population),\n    color = NA\n  ) +\n  scale_fill_viridis_c(option = \"plasma\") +\n  coord_sf(crs = 4326) +\n  theme(legend.position = \"right\") +\n  labs(\n    x = NULL,\n    y = NULL,\n    fill = \"Population\"\n  )"
  },
  {
    "objectID": "index.html#compute-maximal-coverage-location-allocation",
    "href": "index.html#compute-maximal-coverage-location-allocation",
    "title": "",
    "section": "Compute Maximal Coverage Location-Allocation",
    "text": "Compute Maximal Coverage Location-Allocation\n\n\n\n\n\n\nThis process may require substantial computational resources, depending on the area’s size and the number of establishments analyzed. Ensure your system has adequate capacity before proceeding.\n\n\n\nFilter Locais-Nova Group\n\nallocation_data &lt;-\n  data |&gt;\n  filter(group == \"G0\") |&gt;\n  st_transform(st_crs(\"WGS84\"))\n\nNormalize Municipality Shape CRS\n\nallocation_shape &lt;-\n  shape |&gt;\n  st_transform(st_crs(\"WGS84\"))\n\nPlot Food Establishments\n\n\n\n\n\n\nThis plot illustrates the spatial distribution of food establishments within the selected Locais-Nova scale group.\n\n\n\n\nggplot() +\n  geom_sf(\n    data = shape,\n    fill = \"gray90\",\n    color = \"black\"\n  ) +\n  geom_sf(\n    data = data,\n    color = get_brand_color(\"blue\"),\n    size = 0.01\n  ) +\n  coord_sf(crs = \"WGS84\") +\n  scale_color_brand_d() +\n  theme(legend.position = \"none\") +\n  labs(x = NULL, y = NULL)\n\n\n\n\n\n\n\nCompute Travel Time\n\ntravel_time_data &lt;-\n  allocation_data |&gt;\n  traveltime(\n    bb_area = allocation_shape,\n    dowscaling_model_type = \"lm\",\n    mode = \"walk\",\n    res_output = 100\n  )\n\nPlot Travel Time\n\n\n\n\n\n\nThis plot illustrates walking travel times from food establishments within the selected Locais-Nova scale group, considering the spatial friction of the area. Contour lines represent travel times up to the specified objective minutes.\n\n\n\n\ntravel_time_data |&gt;\n  traveltime_plot(\n    bb_area = allocation_shape,\n    facilities = allocation_data,\n    contour_traveltime = objective_minutes\n  )\n\n\n\n\n\n\n\nRasterize Population Data\n\ncensus_raster_data &lt;-\n  census_data |&gt;\n  dplyr::select(-tract_code) |&gt;\n  st_transform(st_crs(\"WGS84\")) |&gt;\n  st_rasterize() |&gt;\n  as(\"Raster\")\n\nCompute Travel Time Stats\n\n\n\n\n\n\nThis plot illustrates the cumulative population coverage achieved within the specified travel time intervals from food establishments in the selected Locais-Nova scale group, highlighting accessibility patterns and potential gaps in coverage.\n\n\n\n\ntravel_time_stats &lt;-\n  travel_time_data |&gt;\n  traveltime_stats(\n    demand = census_raster_data,\n    breaks = c(5, 10, 15, 30),\n    objectiveminutes = objective_minutes\n  )\n#&gt; ℹ 87.51% of coverage within the 15 minutes threshold.\n\n\n\n\n\n\n\nCompute Location-Allocation (Continuous Approach)\n\nallocation &lt;-\n  census_raster_data |&gt;\n  allocation(\n    bb_area = shape,\n    facilities = allocation_data,\n    traveltime = travel_time_data,\n    weights = NULL,\n    objectiveminutes = objective_minutes,\n    objectiveshare = 0.95,\n    heur = \"max\",\n    approach = \"norm\",\n    exp_demand = 1,\n    exp_weights = 1\n  )\n#&gt; [1] \"Fraction of unmet demand:  12.1534437843047 %\"\n#&gt; [1] \"Fraction of unmet demand:  11.2847696998063 %\"\n#&gt; [1] \"Fraction of unmet demand:  11.0585620628387 %\"\n#&gt; [1] \"Fraction of unmet demand:  9.94214807418508 %\"\n#&gt; [1] \"Fraction of unmet demand:  7.94158021807322 %\"\n#&gt; [1] \"Fraction of unmet demand:  7.91344091967339 %\"\n#&gt; [1] \"Fraction of unmet demand:  7.91344091967339 %\"\n#&gt; [1] \"Fraction of unmet demand:  6.47803566149058 %\"\n#&gt; [1] \"Fraction of unmet demand:  6.47803566149058 %\"\n#&gt; [1] \"Fraction of unmet demand:  2.99186020092346 %\"\n\nPlot Location-Allocation (Continuous Approach)\n\n\n\n\n\n\nThis plot illustrates the amount and optimal locations for food establishments within the selected Locais-Nova scale group, considering the objective travel time and population coverage.\n\n\n\n\nallocation |&gt; allocation_plot(bb_area = shape)\n\n\n\n\n\n\n\nCompute Location-Allocation (Discrete Approach)\n\nallocation &lt;-\n  census_raster_data |&gt;\n  allocation_discrete(\n    bb_area = shape,\n    candidate = shape, # |&gt; st_sample(20),\n    facilities = allocation_data,\n    n_fac = 30,\n    n_samples = 1000,\n    traveltime = traveltime,\n    weights = NULL,\n    objectiveminutes = objective_minutes,\n    objectiveshare = 0.95,\n    approach = \"norm\",\n    exp_demand = 1,\n    exp_weights = 1,\n    par = TRUE\n  )\n\nPlot Location-Allocation (Discrete Approach)\n\n\n\n\n\n\nThis plot illustrates the amount and optimal locations for food establishments within the selected Locais-Nova scale group, considering the amount of facilities, objective travel time, and population coverage.\n\n\n\n\nallocation |&gt; allocation_plot_discrete(bb_area = shape)"
  },
  {
    "objectID": "index.html#citation",
    "href": "index.html#citation",
    "title": "",
    "section": "Citation",
    "text": "Citation\n\n\n\n\n\n\nWhen using this data, you must also cite the original data sources.\n\n\n\nTo cite this work, please use the following format:\nVartanian, D., Silva, L. G., Fernandes, C. N., & Giannotti, M. A. (2025). A reproducible pipeline for maximal coverage location-allocation of food establishments in Brazil using the Locais-Nova scale [Computer software]. Center for Metropolitan Studies of the University of São Paulo. https://cem-usp.github.io/locais-nova-location-allocation\nA BibLaTeX entry for LaTeX users is:\n@software{silva2025,\n  title = {A reproducible pipeline for maximal coverage location-allocation of food establishments in Brazil using the Locais-Nova scale},\n  author = {{Daniel Vartanian} and {Letícia Gonçalves Silva} and {Camila Nastari Fernandes} and {Mariana Abrantes Giannotti}},\n  year = {2025},\n  address = {São Paulo},\n  institution = {Center for Metropolitan Studies of the University of São Paulo},\n  langid = {en},\n  url = {https://cem-usp.github.io/locais-nova-location-allocation}\n}"
  },
  {
    "objectID": "index.html#license",
    "href": "index.html#license",
    "title": "",
    "section": "License",
    "text": "License\n\n \n\n\n\n\n\n\n\nThe original data sources may be subject to their own licensing terms and conditions.\n\n\n\nThe code in this repository is licensed under the GNU General Public License Version 3, while the report is available under the Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International.\nCopyright (C) 2025 Center for Metropolitan Studies\n\nThe code in this report is free software: you can redistribute it and/or\nmodify it under the terms of the GNU General Public License as published by the\nFree Software Foundation, either version 3 of the License, or (at your option)\nany later version.\n\nThis program is distributed in the hope that it will be useful, but WITHOUT ANY\nWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A\nPARTICULAR PURPOSE. See the GNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License along with\nthis program. If not, see &lt;https://www.gnu.org/licenses/&gt;."
  },
  {
    "objectID": "index.html#acknowledgments",
    "href": "index.html#acknowledgments",
    "title": "",
    "section": "Acknowledgments",
    "text": "Acknowledgments\n\n\n\n\n\nThis work is part of a research project by the Polytechnic School (Poli) of the University of São Paulo (USP), in partnership with the Secretariat for Food and Nutrition Security (SESAN) of the Ministry of Social Development, Family, and the Fight Against Hunger (MDS), titled: AcessoSAN: Mapping Food Access to Support Public Policies on Food and Nutrition Security and Hunger Reduction in Brazilian Cities.\n\n\n\n\n\n\nThis work was developed with support from the Center for Metropolitan Studies (CEM) based at the School of Philosophy, Letters and Human Sciences (FFLCH) of the University of São Paulo (USP) and at the Brazilian Center for Analysis and Planning (CEBRAP).\n\n\n\n\n\n\nThis study was financed, in part, by the São Paulo Research Foundation (FAPESP), Brazil. Process Number 2025/17879-2."
  },
  {
    "objectID": "index.html#references",
    "href": "index.html#references",
    "title": "",
    "section": "References",
    "text": "References\n\n\nAllaire, J. J., Teague, C., Xie, Y., & Dervieux, C. (n.d.). Quarto [Computer software]. Zenodo. https://doi.org/10.5281/ZENODO.5960048\n\n\nBrasil, Ministério da Saúde, & Departamento de Informática do SUS. (n.d.). Banco de dados do Sistema Único de Saúde - DATASUS. Retrieved July 17, 2024, from https://datasus.saude.gov.br/\n\n\nBrasil, & Sistema de Vigilância Alimentar e Nutricional. (n.d.). Módulo gerador de relatórios públicos: estado nutricional dos indivíduos acompanhados por período, fase do ciclo da vida e índice. Retrieved September 23, 2024, from https://sisaps.saude.gov.br/sisvan/relatoriopublico\n\n\nMalaria Atlas Project. (2019). Friction surface: Global walking only friction surface (Version 202001) [GeoTIFF]. https://data.malariaatlas.org/maps?layers=Accessibility:202001_Global_Walking_Only_Friction_Surface\n\n\nOpenStreetMap Contributors. (n.d.). OpenStreetMap [Computer software]. OpenStreetMap Foundation. https://www.openstreetmap.org\n\n\nPereira, R. H. M., & Goncalves, C. N. (n.d.). geobr: Download official spatial data sets of Brazil [Computer software]. https://doi.org/10.32614/CRAN.package.geobr\n\n\nPereira, R. H. M., & Herszenhut, D. (n.d.). geocodebr: Geolocalização de endereços brasileiros [Computer software]. https://doi.org/10.32614/CRAN.package.geocodebr\n\n\nR Core Team. (n.d.). R: A language and environment for statistical computing [Computer software]. R Foundation for Statistical Computing. https://www.R-project.org\n\n\nSilva, M. A. L. da, Mendes, L. L., Leite, M. A., Rocha, L. L., Borges, C. A., Levy, R. B., & Louzada, M. L. da C. (2025). Sistema de classificação dos locais de aquisição de alimentos com base no Guia Alimentar para a População Brasileira: Locais-Nova. Epidemiologia e Serviços de Saúde, 34, e20240361. https://doi.org/10.1590/S2237-96222025v34.20240361.pt\n\n\nUshey, K., & Wickham, H. (n.d.). renv: Project environments [Computer software]. https://doi.org/10.32614/CRAN.package.renv\n\n\nVartanian, D., Penz, C. de L. e. S., Caldeira, G., Fernandes, C. N., & Giannotti, M. A. (2025). A reproducible pipeline for processing, geocoding, and classifying CNPJs from the Brazilian Federal Revenue Service (RFB) using the Locais-Nova scale [Computer software]. Center for Metropolitan Studies of the University of São Paulo. https://cem-usp.github.io/locais-nova-rfb-geocoding\n\n\nWickham, H. (n.d.-a). The tidyverse style guide. Retrieved July 17, 2023, from https://style.tidyverse.org\n\n\nWickham, H. (n.d.-b). Tidy design principles. https://design.tidyverse.org\n\n\nWickham, H. (2023). The tidy tools manifesto. Tidyverse. https://tidyverse.tidyverse.org/articles/manifesto.html\n\n\nWickham, H., Çetinkaya-Rundel, M., & Grolemund, G. (2023). R for data science: Import, tidy, transform, visualize, and model data (2nd ed.). O’Reilly Media. https://r4ds.hadley.nz"
  }
]